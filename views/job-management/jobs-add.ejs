<link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.3/toastr.min.css" rel="stylesheet" />
<link href="/assets/global/plugins/bootstrap-fileinput/bootstrap-fileinput.css" rel="stylesheet" type="text/css" />

    <div class="page-content-wrapper">
        <div class="page-content">
            <div class="page-bar">
                <ul class="page-breadcrumb">
                    <li><span><a href="/dashboard">Home</a></span><i class="fa fa-circle"></i></li>
                    <li><span>Jobs</span><i class="fa fa-circle"></i></li>
                    <li><span><a href="/jobs">Jobs</a></span><i class="fa fa-circle"></i></li>
                    <li><span>Add</span></li>
                </ul>  
            </div>
            <h1 class="page-title"></h1> 
            <div class="row">
                <div class="col-md-12">
                    <div id="form-alerts"> </div>
                    <div class="portlet light portlet-fit portlet-form bordered">
                        <div class="portlet-title">
                            <div class="caption font-blue-hoki">
                                <i class="fa fa-cubes font-blue-hoki"></i>
                                <span class="caption-subject sbold uppercase"> Add Job</span>
                            </div>
                        </div>
                        <div class="portlet-body">
                            
                        <form action="<%= api.url %>/api/job?token=<%= user.token %>" id="jobs_add_form" class="form-horizontal" enctype="multipart/form-data">
                            
                                <div class="form-body">
                                    <div class="form-group">
                                        <label class="control-label col-md-3">Lead Id
                                        </label>
                                        <div class="col-md-4">
                                            <select id="leadId" class="form-control select2-multiple select2-hidden-accessible" name="leadId">
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="control-label col-md-3">Customer
                                            <span class="required"> * </span>
                                        </label>
                                        <div class="col-md-4">
                                            <select id="customerId" class="form-control select2-multiple select2-hidden-accessible" name="customerId">
                                            </select> 
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="control-label col-md-3">Service 
                                        </label>
                                        <div class="col-md-4">
                                            <select id="itemId" class="form-control select2-multiple select2-hidden-accessible" name="itemId">
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="control-label col-md-3">Reference Number
                                        </label>
                                        <div class="col-md-4">
                                            <input type="text" class="form-control" name="referenceNumber" id="referenceNumber">
                                            </select>
                                        </div>
                                    </div>

                                    <!-- <div class="form-group">
                                        <label class="control-label col-md-3">Requested Due Date
                                        </label>
                                        <div class="col-md-4">
                                            <input type="text" value="" size="16" class="form-control form-control-inline date-picker" name="requestedDueDate" id="requestedDueDate" data-date-format="dd-mm-yyyy">
                                        </div>
                                    </div> -->

                                    <div class="form-group">
                                        <label class="control-label col-md-3">Start Date
                                        </label>
                                        <div class="col-md-4">
                                            <input type="text" value="" size="16" class="form-control form-control-inline date-picker" name="scheduledDueDate" id="scheduledDueDate" data-date-format="mm-dd-yyyy">
                                        </div>
                                        <!-- <div class="col-md-2">
                                            <input type="text" class="form-control timepicker timepicker-24">
                                        </div> -->
                                    </div>

                                    <!-- <div class="form-group">
                                        <label class="control-label col-md-3">Estimated Due Date
                                        </label>
                                        <div class="col-md-4">
                                            <input type="text" value="" size="16" class="form-control form-control-inline date-picker" name="estimateDueDate" id="estimateDueDate" data-date-format="dd-mm-yyyy">
                                        </div>
                                    </div> -->

                                    <div class="form-group">
                                        <label class="control-label col-md-3">End Date
                                        </label>
                                        <div class="col-md-4">
                                            <input type="text" value="" size="16" class="form-control form-control-inline date-picker" name="completionDueDate" id="completionDueDate" data-date-format="mm-dd-yyyy">
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="control-label col-md-3">Estimated Total
                                        </label>
                                        <div class="col-md-4">
                                            <input type="text" class="form-control" name="estimatedTotal" id="estimatedTotal" value="0.0">
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="control-label col-md-3">Net Total
                                        </label>
                                        <div class="col-md-4">
                                            <input type="text" class="form-control" name="netTotal" id="netTotal" value="0.0">
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="control-label col-md-3">Taxes (%)
                                        </label>
                                        <div class="col-md-4">
                                            <input type="text" class="form-control" name="taxes" id="taxes" value="0.0">
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="control-label col-md-3" id="amountTotalDiv">Gross Total
                                        </label>
                                        <div class="col-md-4">
                                            <input type="text" class="form-control" name="grossTotal" id="grossTotal" value="0">
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="control-label col-md-3">Reviewed
                                        </label>
                                        <div class="col-md-4">
                                            <select class="form-control select2-multiple select2-hidden-accessible" name="reviewed" id="reviewed">
                                                <option value="true" selected="true">Yes</option>
                                                <option value="false">No</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="control-label col-md-3">Payment Collected
                                        </label>
                                        <div class="col-md-4">
                                            <select class="form-control select2-multiple select2-hidden-accessible" name="paymentCollected" id="paymentCollected">
                                                <option value="true" selected="true">Yes</option>
                                                <option value="false">No</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="control-label col-md-3">Service Agreement Needed
                                        </label>
                                        <div class="col-md-4">
                                            <select class="form-control select2-multiple select2-hidden-accessible" name="serviceAgreementNeeded" id="serviceAgreementNeeded">
                                                <option value="true" selected="true">Yes</option>
                                                <option value="false">No</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="control-label col-md-3"> Job Status
                                        </label>
                                        <div class="col-md-4">
                                            <select class="form-control select2-multiple select2-hidden-accessible" name="jobStatus" id="jobStatus">
                                                <option value="open">Open</option>
                                                <option value="waiting-for-service-agreement">Waiting for Service Agreement</option>
                                                <option value="service-agreement-sent">Service Agreement Sent</option>
                                                <option value="service-agreement-signed">Service Agreement Signed</option>
                                                <option value="assigend">Assigend</option>
                                                <option value="in-progress">In Progress</option>
                                                <option value="on-hold">On Hold</option>
                                                <option value="review-pending">Review Pending</option>
                                                <option value="completed">Completed</option>
                                                <option value="re-open">Re-Open</option>
                                                <option value="cancelled">Cancelled</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-actions">
                                    <div class="row">
                                        <div class="col-md-offset-3 col-md-9">
                                            <button class="btn green" type="submit" id="addJob"> Submit </button>
                                            <button type="reset" class="btn default">Reset</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


<script type="text/javascript">
    $().ready(function() {
        var token = '<%= user.token %>';
        var sUrl = '<%= api.url %>';
        populateLeads(buildUrl(sUrl,'leads', token, '<%= defaults.psize %>'));
        populateItems(buildUrl(sUrl,'items', token, '<%= defaults.psize %>'),false);
        populateCustomers(buildUrl(sUrl,'customers', token, '<%= defaults.psize %>'),false);


         $("#netTotal").bind("change paste keyup", function() {
            if($.isNumeric($("#netTotal").val()) && $.isNumeric($('#taxes').val())){
                $('#taxes').val($("#netTotal").val());
                $('#amountDueDiv').removeClass("hide");
                $('#grossTotal').val(parseFloat($('#netTotal').val()) - ((parseFloat($('#netTotal').val()) * parseFloat($('#taxes').val()))/100));
            }
        });
        $("#taxes").bind("change paste keyup", function() {
            if($.isNumeric($("#netTotal").val()) && $.isNumeric($('#taxes').val())){
                $('#amountTotalDiv').removeClass("hide");
                $('#grossTotal').val(parseFloat($('#netTotal').val()) - ((parseFloat($('#netTotal').val()) * parseFloat($('#taxes').val()))/100));
            }
        });
        
    });
</script>

<script src="/js/onground/job-management/jobs-add.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.3/toastr.min.js"></script>
<script src="/assets/global/plugins/bootstrap-fileinput/bootstrap-fileinput.js" type="text/javascript"></script>